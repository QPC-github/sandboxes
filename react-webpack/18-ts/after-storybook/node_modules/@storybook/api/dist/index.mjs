import{a as I,g as Ie,h as Te}from"./chunk-WDQX4E6P.mjs";import N,{Component as Go,Fragment as Ho,useCallback as Ze,useContext as Re,useEffect as Uo,useMemo as Ee,useRef as et}from"react";import _o from"lodash/mergeWith";import{STORY_CHANGED as $o,SHARED_STATE_CHANGED as tt,SHARED_STATE_SET as U,SET_STORIES as Ko}from"@storybook/core-events";import{createContext as rt}from"react";var Ae=({api:e,state:t})=>rt({api:e,state:t});import L from"store2";import{parse as nt,stringify as st}from"telejson";var we=e=>{e.fn("set",function(t,r){return e.set(this._area,this._in(t),st(r,{maxDepth:50}))}),e.fn("get",function(t,r){let a=e.get(this._area,this._in(t));return a!==null?nt(a):r||a})};we(L._);var Ce="@storybook/ui/store";function Z(e){return e.get(Ce)||{}}function at(e,t){return e.set(Ce,t)}function it(e,t){let r=Z(e);return at(e,{...r,...t})}var F=class{constructor({setState:t,getState:r}){this.upstreamSetState=t,this.upstreamGetState=r}getInitialState(t){return{...t,...Z(L.local),...Z(L.session)}}getState(){return this.upstreamGetState()}async setState(t,r,a){let d,p;typeof r=="function"?(d=r,p=a):p=r;let{persistence:c="none"}=p||{},n={},l={};typeof t=="function"?n=o=>(l=t(o),l):(n=t,l=n);let s=await new Promise(o=>{this.upstreamSetState(n,o)});if(c!=="none"){let o=c==="session"?L.session:L.local;await it(o,l)}return d&&d(s),s}};import ct from"lodash/mergeWith";import dt from"lodash/isEqual";import{logger as lt}from"@storybook/client-logger";var T=(e,t)=>ct({},e,t,(r,a)=>{if(Array.isArray(a)&&Array.isArray(r))return a.forEach(d=>{r.find(c=>c===d||dt(c,d))||r.push(d)}),r;if(Array.isArray(r))return lt.log(["the types mismatch, picking",r]),r});var pt=(...e)=>e.reduce((t,r)=>T(t,r),{}),_=pt;var ee={};I(ee,{init:()=>ut});var ut=({provider:e,fullAPI:t})=>({api:e.renderPreview?{renderPreview:e.renderPreview}:{},state:{},init:()=>{e.handleAPI(t)}});var oe={};I(oe,{ensurePanel:()=>te,init:()=>mt,types:()=>Oe});import yt from"util-deprecate";import{dedent as St}from"ts-dedent";var ft=yt(()=>{},St`
    Use 'parameters.key.disable' instead of 'parameters.key.disabled'.
    
    https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-disabled-parameter
  `),Oe=(p=>(p.TAB="tab",p.PANEL="panel",p.TOOL="tool",p.PREVIEW="preview",p.NOTES_ELEMENT="notes-element",p))(Oe||{});function te(e,t,r){let a=Object.keys(e);return a.indexOf(t)>=0?t:a.length?a[0]:r}var mt=({provider:e,store:t,fullAPI:r})=>{let a={getElements:d=>e.getElements(d),getPanels:()=>a.getElements("panel"),getStoryPanels:()=>{let d=a.getPanels(),{storyId:p}=t.getState(),c=r.getData(p);if(!d||!c||c.type!=="story")return d;let{parameters:n}=c,l={};return Object.entries(d).forEach(([s,o])=>{let{paramKey:i}=o;if(i&&n&&n[i]&&(n[i].disabled||n[i].disable)){n[i].disabled&&ft();return}l[s]=o}),l},getSelectedPanel:()=>{let{selectedPanel:d}=t.getState();return te(a.getPanels(),d,d)},setSelectedPanel:d=>{t.setState({selectedPanel:d},{persistence:"session"})},setAddonState(d,p,c){let n,{addons:l}=t.getState();return typeof p=="function"?n=p(a.getAddonState(d)):n=p,t.setState({addons:{...l,[d]:n}},c).then(()=>a.getAddonState(d))},getAddonState:d=>t.getState().addons[d]};return{api:a,state:{selectedPanel:te(a.getPanels(),t.getState().selectedPanel),addons:{}}}};var re={};I(re,{init:()=>bt});import{STORIES_COLLAPSE_ALL as gt,STORIES_EXPAND_ALL as ht}from"@storybook/core-events";var bt=({provider:e})=>{let t={getChannel:()=>e.channel,on:(r,a)=>(e.channel.addListener(r,a),()=>e.channel.removeListener(r,a)),off:(r,a)=>e.channel.removeListener(r,a),once:(r,a)=>e.channel.once(r,a),emit:(r,a,...d)=>{a?.options?.target&&a.options.target!=="storybook-preview-iframe"&&!a.options.target.startsWith("storybook-ref-")&&(a.options.target=a.options.target!=="storybook_internal"?`storybook-ref-${a.options.target}`:"storybook-preview-iframe"),e.channel.emit(r,a,...d)},collapseAll:()=>{e.channel.emit(gt,{})},expandAll:()=>{t.emit(ht)}};return{api:t,state:{}}};var ne={};I(ne,{init:()=>Pt});var Pt=({store:e})=>{let t={addNotification:a=>{t.clearNotification(a.id);let{notifications:d}=e.getState();e.setState({notifications:[...d,a]})},clearNotification:a=>{let{notifications:d}=e.getState();e.setState({notifications:d.filter(c=>c.id!==a)});let p=d.find(c=>c.id===a);p&&p.onClear&&p.onClear()}};return{api:t,state:{notifications:[]}}};var se={};I(se,{init:()=>vt});var vt=({store:e,navigate:t,fullAPI:r})=>{let a=()=>{let{path:p}=r.getUrlState();return!!(p||"").match(/^\/settings/)};return{state:{settings:{lastTrackedStoryId:null}},api:{closeSettings:()=>{let{settings:{lastTrackedStoryId:p}}=e.getState();p?r.selectStory(p):r.selectFirstStory()},changeSettingsTab:p=>{t(`/settings/${p}`)},isSettingsScreenActive:a,navigateToSettingsPage:async p=>{if(!a()){let{settings:c,storyId:n}=e.getState();await e.setState({settings:{...c,lastTrackedStoryId:n}})}t(p)}}}};var ae={};I(ae,{init:()=>Tt});import xt from"global";import Et from"memoizerific";var{RELEASE_NOTES_DATA:Rt}=xt,It=Et(1)(()=>{try{return{...JSON.parse(Rt)||{}}}catch{return{}}}),Tt=({store:e})=>{let t=It(),r=()=>{let{releaseNotesViewed:d}=e.getState();return d||[]};return{state:{releaseNotesViewed:[]},api:{releaseNotesVersion:()=>t.currentVersion,setDidViewReleaseNotes:()=>{let d=r();d.includes(t.currentVersion)||e.setState({releaseNotesViewed:[...d,t.currentVersion]},{persistence:"permanent"})},showReleaseNotesOnLaunch:()=>{if(!t.currentVersion)return!1;let p=r().includes(t.currentVersion);return t.showOnFirstLaunch&&!p}}}};var ue={};I(ue,{init:()=>io});import Kt from"global";import{toId as K,sanitize as _e}from"@storybook/csf";import{PRELOAD_ENTRIES as Bt,STORY_PREPARED as qt,UPDATE_STORY_ARGS as Qt,RESET_STORY_ARGS as Wt,STORY_ARGS_UPDATED as Yt,STORY_CHANGED as zt,SELECT_STORY as Xt,SET_STORIES as Jt,STORY_SPECIFIED as Zt,STORY_INDEX_INVALIDATED as eo,CONFIG_ERROR as to}from"@storybook/core-events";import oo from"util-deprecate";import{logger as ro}from"@storybook/client-logger";import{logger as $t}from"@storybook/client-logger";var le={};I(le,{defaultStoryMapper:()=>Ue,getSourceType:()=>de,init:()=>_t});import He from"global";import{dedent as jt}from"ts-dedent";import ke from"memoizerific";import De from"util-deprecate";import{dedent as ie}from"ts-dedent";import At from"lodash/mapValues";import wt from"lodash/countBy";import Ct from"global";import{toId as Ot,sanitize as kt}from"@storybook/csf";var{FEATURES:Dt}=Ct,Mt=De(()=>{},ie`
    The 'showRoots' config option is deprecated and will be removed in Storybook 7.0. Use 'sidebar.showRoots' instead.
    Read more about it in the migration guide: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md
  `),Nt=De(()=>{},ie`
    The default hierarchy separators changed in Storybook 6.0.
    '|' and '.' will no longer create a hierarchy, but codemods are available.
    Read more about it in the migration guide: https://github.com/storybookjs/storybook/blob/master/MIGRATION.md
  `),Me=({globalParameters:e,kindParameters:t,stories:r})=>At(r,a=>({...a,parameters:Ve(e,t[a.kind],a.parameters)})),Lt=/\s*\/\s*/,$=(e,{provider:t,docsOptions:r})=>V(Ft(e,{docsOptions:r}),{provider:t,docsOptions:r}),Ft=(e,{docsOptions:t})=>{let r=new Set,a=Object.entries(e).reduce((d,[p,c])=>{if(!c)return d;let{docsOnly:n,fileName:l,...s}=c.parameters,o={title:c.kind,id:p,name:c.name,importPath:l};if(n)d[p]={type:"docs",storiesImports:[],...o};else{if(!r.has(o.title)&&t.docsPage){let S=t.defaultName,y=Ot(c.componentId||o.title,S);r.add(o.title),d[y]={type:"docs",storiesImports:[],...o,id:y,name:S}}let{argTypes:i,args:u,initialArgs:f}=c;d[p]={type:"story",...o,parameters:s,argTypes:i,args:u,initialArgs:f}}return d},{});return{v:4,entries:a}},Vt=e=>{let t=wt(Object.values(e.stories),"title");return{v:4,entries:Object.values(e.stories).reduce((r,a)=>{let d="story";return(a.parameters?.docsOnly||a.name==="Page"&&t[a.title]===1)&&(d="docs"),r[a.id]={type:d,...d==="docs"&&{storiesImports:[]},...a},r},{})}},V=(e,{provider:t,docsOptions:r})=>{if(!e.v)throw new Error("Composition: Missing stories.json version");let a=e.v===4?e:Vt(e),d=Object.values(a.entries),{sidebar:p={},showRoots:c}=t.getConfig(),{showRoots:n=c,collapsedRoots:l=[],renderLabel:s}=p,o=d.some(({title:y})=>y.match(/\.|\|/));typeof c<"u"&&Mt();let i=typeof n<"u";o&&!i&&Dt?.warnOnLegacyHierarchySeparator&&Nt();let u=Object.values(d).reduce((y,m)=>{if(r.docsMode&&m.type!=="docs")return y;let{title:g}=m,h=g.trim().split(Lt),v=(!i||n)&&h.length>1?[h.shift()]:[],E=[...v,...h],x=E.reduce((P,R,O)=>{let X=O>0&&P[O-1],J=kt(X?`${X}-${R}`:R);if(X===J)throw new Error(ie`
          Invalid part '${R}', leading to id === parentId ('${J}'), inside title '${g}'
          
          Did you create a path that uses the separator char accidentally, such as 'Vue <docs/>' where '/' is a separator char? See https://github.com/storybookjs/storybook/issues/6128
          `);return P.push(J),P},[]);return x.forEach((P,R)=>{let O=x[R+1]||m.id;v.length&&R===0?y[P]=T(y[P]||{},{type:"root",id:P,name:E[R],depth:R,renderLabel:s,startCollapsed:l.includes(P),children:[O],isRoot:!0,isComponent:!1,isLeaf:!1}):(!y[P]||y[P].type==="component")&&R===x.length-1?y[P]=T(y[P]||{},{type:"component",id:P,name:E[R],parent:x[R-1],depth:R,renderLabel:s,...O&&{children:[O]},isRoot:!1,isComponent:!0,isLeaf:!1}):y[P]=T(y[P]||{},{type:"group",id:P,name:E[R],parent:x[R-1],depth:R,renderLabel:s,...O&&{children:[O]},isRoot:!1,isComponent:!1,isLeaf:!1})}),y[m.id]={type:"story",...m,depth:x.length,parent:x[x.length-1],renderLabel:s,...m.type!=="docs"&&{prepared:!!m.parameters},kind:m.title,isRoot:!1,isComponent:!1,isLeaf:!0},y},{});function f(y,m){return y[m.id]||(y[m.id]=m,(m.type==="root"||m.type==="group"||m.type==="component")&&m.children.forEach(g=>f(y,u[g]))),y}let S=Object.values(u).filter(y=>y.type!=="root"&&!y.parent).reduce(f,{});return Object.values(u).filter(y=>y.type==="root").reduce(f,S)},Ne=(e,t)=>t?Object.fromEntries(Object.entries(e).map(([r,a])=>{let d=t[r];return a.type==="story"&&d?.type==="story"&&d.prepared?[r,{...d,...a,prepared:!0}]:[r,a]})):e,Le=ke(1)(e=>Object.entries(e).reduce((t,r)=>{let a=r[1];return a.type==="component"&&t.push([...a.children]),t},[])),Fe=ke(1)(e=>Object.keys(e).filter(t=>["story","docs"].includes(e[t].type)));var{location:Gt,fetch:je}=He,Ge=/(\/((?:[^\/]+?)\.[^\/]+?)|\/)$/,de=(e,t)=>{let{origin:r,pathname:a}=Gt,{origin:d,pathname:p}=new URL(e),c=`${r+a}`.replace(Ge,""),n=`${d+p}`.replace(Ge,"");return c===n?["local",n]:t||e?["external",n]:[null,null]},Ue=(e,t)=>({...t,kind:t.kind.replace("|","/")}),Ht=(e,t)=>Object.entries(e).reduce((r,[a,d])=>({...r,[a]:{...d,refId:t.id}}),{});async function ce(e){if(!e)return{};try{let t=await e;if(!t.ok)return{};let r=await t.json();return r.entries||r.stories?{storyIndex:r}:r}catch(t){return{error:t}}}var Ut=(e,t,r)=>{let{storyMapper:a}=r;return a?Object.entries(e).reduce((d,[p,c])=>({...d,[p]:a(t,c)}),{}):e},_t=({store:e,provider:t,singleStory:r,docsOptions:a={}},{runCheck:d=!0}={})=>{let p={findRef:l=>{let s=p.getRefs();return Object.values(s).find(({url:o})=>o.match(l))},changeRefVersion:(l,s)=>{let{versions:o,title:i}=p.getRefs()[l],u={id:l,url:s,versions:o,title:i,stories:{}};p.checkRef(u)},changeRefState:(l,s)=>{let{[l]:o,...i}=p.getRefs();i[l]={...o,ready:s},e.setState({refs:i})},checkRef:async l=>{let{id:s,url:o,version:i,type:u}=l,f=u==="server-checked",S={},y=i?`?version=${i}`:"",m=f?"omit":"include",[g,h]=await Promise.all(["index.json","stories.json"].map(async E=>je(`${o}/${E}${y}`,{headers:{Accept:"application/json"},credentials:m})));if(g.ok||h.ok){let[E,x]=await Promise.all([g.ok?ce(g):ce(h),ce(je(`${o}/metadata.json${y}`,{headers:{Accept:"application/json"},credentials:m,cache:"no-cache"}).catch(()=>!1))]);Object.assign(S,{...E,...x})}else f||(S.error={message:jt`
            Error: Loading of ref failed
              at fetch (lib/api/src/modules/refs.ts)

            URL: ${o}

            We weren't able to load the above URL,
            it's possible a CORS error happened.

            Please check your dev-tools network tab.
          `});let v=l.versions&&Object.keys(l.versions).length?l.versions:S.versions;await p.setRef(s,{id:s,url:o,...S,...v?{versions:v}:{},type:S.storyIndex?"lazy":"auto-inject"})},getRefs:()=>{let{refs:l={}}=e.getState();return l},setRef:(l,{storyIndex:s,setStoriesData:o,...i},u=!1)=>{if(r)return;let{storyMapper:f=Ue}=t.getConfig(),S=p.getRefs()[l],y;o?y=$(Ut(o,S,{storyMapper:f}),{provider:t,docsOptions:a}):s&&(y=V(s,{provider:t,docsOptions:a})),y&&(y=Ht(y,S)),p.updateRef(l,{stories:y,...i,ready:u})},updateRef:(l,s)=>{let{[l]:o,...i}=p.getRefs();i[l]={...o,...s};let u=Object.keys(n).reduce((f,S)=>(f[S]=i[S],f),{});e.setState({refs:u})}},c=!r&&He.REFS||{},n=c;return d&&Object.entries(c).forEach(([l,s])=>{p.checkRef({...s,stories:{}})}),{api:p,state:{refs:n}}};var A=(e,t)=>{let{source:r,refId:a,type:d}=e,[p,c]=de(r,a),n=a&&t.getRefs()[a]?t.getRefs()[a]:t.findRef(c),l={source:r,sourceType:p,sourceLocation:c,refId:a,ref:n,type:d};switch(!0){case typeof a=="string":case p==="local":case p==="external":return l;default:return $t.warn(`Received a ${d} frame that was not configured as a ref`),null}};var{FEATURES:no,fetch:so}=Kt,ao="./index.json",$e=["enableShortcuts","theme","showRoots"].reduce((e,t)=>(e[t]=oo(()=>{},`parameters.options.${t} is deprecated and will be removed in Storybook 7.0.
To change this setting, use \`addons.setConfig\`. See https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-immutable-options-parameters
  `),e),{});function pe(e){!e||Object.keys(e).forEach(t=>{$e[t]&&$e[t]()})}var io=({fullAPI:e,store:t,navigate:r,provider:a,storyId:d,viewMode:p,docsOptions:c={}})=>{let n={storyId:K,getData:(s,o)=>{let i=n.resolveStory(s,o);if(i?.type==="story"||i?.type==="docs")return i},isPrepared:(s,o)=>{let i=n.getData(s,o);return i.type==="story"?i.prepared:!0},resolveStory:(s,o)=>{let{refs:i,storiesHash:u}=t.getState();return o?i[o].stories?i[o].stories[s]:void 0:u?u[s]:void 0},getCurrentStoryData:()=>{let{storyId:s,refId:o}=t.getState();return n.getData(s,o)},getParameters:(s,o)=>{let{storyId:i,refId:u}=typeof s=="string"?{storyId:s,refId:void 0}:s,f=n.getData(i,u);if(f?.type==="story"){let{parameters:S}=f;if(S)return o?S[o]:S}return null},getCurrentParameter:s=>{let{storyId:o,refId:i}=t.getState();return n.getParameters({storyId:o,refId:i},s)||void 0},jumpToComponent:s=>{let{storiesHash:o,storyId:i,refs:u,refId:f}=t.getState();if(!n.getData(i,f))return;let y=f?u[f].stories||{}:o,m=n.findSiblingStoryId(i,y,s,!0);m&&n.selectStory(m,void 0,{ref:f})},jumpToStory:s=>{let{storiesHash:o,storyId:i,refs:u,refId:f}=t.getState(),S=n.getData(i,f);if(!S)return;let y=S.refId?u[S.refId].stories:o,m=n.findSiblingStoryId(i,y,s,!1);m&&n.selectStory(m,void 0,{ref:f})},setStories:async(s,o)=>{let i=$(s,{provider:a,docsOptions:c});await t.setState({storiesHash:i,storiesConfigured:!0,storiesFailed:o})},selectFirstStory:()=>{let{storiesHash:s}=t.getState(),o=Object.keys(s).find(i=>s[i].type==="story");if(o){n.selectStory(o);return}r("/")},selectStory:(s=void 0,o=void 0,i={})=>{let{ref:u}=i,{storyId:f,storiesHash:S,refs:y}=t.getState(),m=u?y[u].stories:S,g=f?.split("--",2)[0];if(o)if(s){let h=u?`${u}_${K(s,o)}`:K(s,o);if(m[h])n.selectStory(h,void 0,i);else{let v=m[_e(s)];if(v?.type==="component"){let E=v.children.find(x=>m[x].name===o);E&&n.selectStory(E,void 0,i)}}}else{let h=K(g,o);n.selectStory(h,void 0,i)}else{let h=s?m[s]||m[_e(s)]:m[g];if(!h)throw new Error(`Unknown id or title: '${s}'`);let v=n.findLeafEntry(m,h.id),E=v.refId?`${v.refId}_${v.id}`:v.id;r(`/${v.type}/${E}`)}},findLeafEntry(s,o){let i=s[o];if(i.type==="docs"||i.type==="story")return i;let u=i.children[0];return n.findLeafEntry(s,u)},findLeafStoryId(s,o){return n.findLeafEntry(s,o)?.id},findSiblingStoryId(s,o,i,u){if(u){let y=Le(o),m=y.findIndex(g=>g.includes(s));return m===y.length-1&&i>0||m===0&&i<0?void 0:y[m+i]?y[m+i][0]:void 0}let f=Fe(o),S=f.indexOf(s);if(!(S===f.length-1&&i>0)&&!(S===0&&i<0))return f[S+i]},updateStoryArgs:(s,o)=>{let{id:i,refId:u}=s;e.emit(Qt,{storyId:i,updatedArgs:o,options:{target:u}})},resetStoryArgs:(s,o)=>{let{id:i,refId:u}=s;e.emit(Wt,{storyId:i,argNames:o,options:{target:u}})},fetchStoryList:async()=>{try{let s=await so(ao);if(s.status!==200)throw new Error(await s.text());let o=await s.json();if(o.v<3){ro.warn(`Skipping story index with version v${o.v}, awaiting SET_STORIES.`);return}await e.setStoryList(o)}catch(s){t.setState({storiesConfigured:!0,storiesFailed:s})}},setStoryList:async s=>{let o=V(s,{provider:a,docsOptions:c}),i=t.getState().storiesHash;await t.setState({storiesHash:Ne(o,i),storiesConfigured:!0,storiesFailed:null})},updateStory:async(s,o,i)=>{if(i){let{id:u,stories:f}=i;f[s]={...f[s],...o},await e.updateRef(u,{stories:f})}else{let{storiesHash:u}=t.getState();u[s]={...u[s],...o},await t.setState({storiesHash:u})}}};return{api:n,state:{storiesHash:{},storyId:d,viewMode:p,storiesConfigured:!1,hasCalledSetOptions:!1},init:async()=>{e.on(Zt,function({storyId:o,viewMode:i}){let{sourceType:u}=A(this,e);if(!e.isSettingsScreenActive()&&u==="local"){let f=t.getState();(f.storyId!==o||f.viewMode!==i)&&r(`/${i}/${o}`)}}),e.on(zt,function(){let{sourceType:o}=A(this,e);if(o==="local"){let i=e.getCurrentParameter("options");i&&(pe(i),e.setOptions(i))}}),e.on(qt,function({id:o,...i}){let{ref:u,sourceType:f}=A(this,e);if(e.updateStory(o,{...i,prepared:!0},u),u)e.updateRef(u.id,{ready:!0});else if(!t.getState().hasCalledSetOptions){let{options:S}=i.parameters;pe(S),e.setOptions(S),t.setState({hasCalledSetOptions:!0})}if(f==="local"){let{storyId:S,storiesHash:y,refId:m}=t.getState(),g=Array.from(new Set([n.findSiblingStoryId(S,y,1,!0),n.findSiblingStoryId(S,y,-1,!0)])).filter(Boolean);e.emit(Bt,{ids:g,options:{target:m}})}}),e.on(Jt,function(o){let{ref:i}=A(this,e),u=o.v?Me(o):o.stories;if(i)e.setRef(i.id,{...i,setStoriesData:u},!0);else{if(!o.v)throw new Error("Unexpected legacy SET_STORIES event from local source");e.setStories(u);let f=e.getCurrentParameter("options");pe(f),e.setOptions(f)}}),e.on(Xt,function({kind:o,story:i,storyId:u,...f}){let{ref:S}=A(this,e);S?e.selectStory(u||o,i,{...f,ref:S.id}):e.selectStory(u||o,i,f)}),e.on(Yt,function({storyId:o,args:i}){let{ref:u}=A(this,e);e.updateStory(o,{args:i},u)}),e.on(to,function(o){t.setState({storiesConfigured:!0,storiesFailed:o})}),no?.storyStoreV7&&(a.serverChannel?.on(eo,()=>e.fetchStoryList()),await e.fetchStoryList())}}};var q={};I(q,{ActiveTabs:()=>Ke,focusableUIElements:()=>G,init:()=>fo});import co from"global";import j from"lodash/pick";import{dequal as B}from"dequal";import{create as lo}from"@storybook/theming/create";import{SET_CONFIG as po}from"@storybook/core-events";import{once as uo}from"@storybook/client-logger";import{dedent as yo}from"ts-dedent";var{document:So}=co,Ke={SIDEBAR:"sidebar",CANVAS:"canvas",ADDONS:"addons"},D={ui:{enableShortcuts:!0},layout:{initialActive:Ke.CANVAS,showToolbar:!0,isFullscreen:!1,showPanel:!0,showNav:!0,panelPosition:"bottom",showTabs:!0},selectedPanel:void 0,theme:lo()},G={storySearchField:"storybook-explorer-searchfield",storyListMenu:"storybook-explorer-menu",storyPanelRoot:"storybook-panel-root"},fo=({store:e,provider:t,singleStory:r,fullAPI:a})=>{let d={toggleFullscreen(c){return e.setState(n=>{let{showNav:l}=n.layout,s=typeof c=="boolean"?c:!n.layout.isFullscreen,o=l===!1&&s===!1;return{layout:{...n.layout,isFullscreen:s,showNav:!r&&o?!0:l}}},{persistence:"session"})},togglePanel(c){return e.setState(n=>{let{showNav:l,isFullscreen:s}=n.layout,o=typeof c<"u"?c:!n.layout.showPanel,i=l===!1&&o===!1;return{layout:{...n.layout,showPanel:o,isFullscreen:i?!0:s}}},{persistence:"session"})},togglePanelPosition(c){return typeof c<"u"?e.setState(n=>({layout:{...n.layout,panelPosition:c}}),{persistence:"permanent"}):e.setState(n=>({layout:{...n.layout,panelPosition:n.layout.panelPosition==="right"?"bottom":"right"}}),{persistence:"permanent"})},toggleNav(c){return e.setState(n=>{if(r)return{layout:n.layout};let{showPanel:l,isFullscreen:s}=n.layout,o=typeof c<"u"?c:!n.layout.showNav,i=l===!1&&o===!1;return{layout:{...n.layout,showNav:o,isFullscreen:i?!0:!o&&s}}},{persistence:"session"})},toggleToolbar(c){return e.setState(n=>{let l=typeof c<"u"?c:!n.layout.showToolbar;return{layout:{...n.layout,showToolbar:l}}},{persistence:"session"})},resetLayout(){return e.setState(c=>({layout:{...c.layout,showNav:!1,showPanel:!1,isFullscreen:!1}}),{persistence:"session"})},focusOnUIElement(c,n){if(!c)return;let l=So.getElementById(c);l&&(l.focus(),n&&l.select())},getInitialOptions(){let{theme:c,selectedPanel:n,...l}=t.getConfig();return l.layout?.isToolshown!==void 0&&(uo.warn(yo`
          The "isToolshown" option is deprecated. Please use "showToolbar" instead.

          See https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#renamed-istoolshown-to-showtoolbar
        `),l.layout.showToolbar=l.layout.isToolshown),{...D,layout:{...D.layout,...j(l,Object.keys(D.layout)),...r&&{showNav:!1}},ui:{...D.ui,...j(l,Object.keys(D.ui))},selectedPanel:n||D.selectedPanel,theme:c||D.theme}},setOptions:c=>{let{layout:n,ui:l,selectedPanel:s,theme:o}=e.getState();if(c){let i={...n,...j(c,Object.keys(n)),...r&&{showNav:!1}},u={...l,...j(c,Object.keys(l))},f={...o,...c.theme},S={};B(l,u)||(S.ui=u),B(n,i)||(S.layout=i),c.selectedPanel&&!B(s,c.selectedPanel)&&(S.selectedPanel=c.selectedPanel),Object.keys(S).length&&e.setState(S,{persistence:"permanent"}),B(o,f)||e.setState({theme:f})}}},p=j(e.getState(),"layout","ui","selectedPanel");return{api:d,state:T(d.getInitialOptions(),p),init:()=>{d.setOptions(T(d.getInitialOptions(),p)),a.on(po,()=>{d.setOptions(T(d.getInitialOptions(),p))})}}};var me={};I(me,{controlOrMetaKey:()=>Q,defaultShortcuts:()=>M,init:()=>bo,isMacLike:()=>qe,keys:()=>fe});import mo from"global";import{PREVIEW_KEYDOWN as go}from"@storybook/core-events";var{navigator:ye,document:Be}=mo,qe=()=>ye&&ye.platform?!!ye.platform.match(/(Mac|iPhone|iPod|iPad)/i):!1,Q=()=>qe()?"meta":"control";function fe(e){return Object.keys(e)}var M=Object.freeze({fullScreen:["F"],togglePanel:["A"],panelPosition:["D"],toggleNav:["S"],toolbar:["T"],search:["/"],focusNav:["1"],focusIframe:["2"],focusPanel:["3"],prevComponent:["alt","ArrowUp"],nextComponent:["alt","ArrowDown"],prevStory:["alt","ArrowLeft"],nextStory:["alt","ArrowRight"],shortcutsPage:[Q(),"shift",","],aboutPage:[","],escape:["escape"],collapseAll:[Q(),"shift","ArrowUp"],expandAll:[Q(),"shift","ArrowDown"]}),Se={};function ho(e){return/input|textarea/i.test(e.target.tagName)||e.target.getAttribute("contenteditable")!==null}var bo=({store:e,fullAPI:t})=>{let r={getShortcutKeys(){return e.getState().shortcuts},getDefaultShortcuts(){return{...M,...r.getAddonsShortcutDefaults()}},getAddonsShortcuts(){return Se},getAddonsShortcutLabels(){let c={};return Object.entries(r.getAddonsShortcuts()).forEach(([n,{label:l}])=>{c[n]=l}),c},getAddonsShortcutDefaults(){let c={};return Object.entries(r.getAddonsShortcuts()).forEach(([n,{defaultShortcut:l}])=>{c[n]=l}),c},async setShortcuts(c){return await e.setState({shortcuts:c},{persistence:"permanent"}),c},async restoreAllDefaultShortcuts(){return r.setShortcuts(r.getDefaultShortcuts())},async setShortcut(c,n){let l=r.getShortcutKeys();return await r.setShortcuts({...l,[c]:n}),n},async setAddonShortcut(c,n){let l=r.getShortcutKeys();return await r.setShortcuts({...l,[`${c}-${n.actionName}`]:n.defaultShortcut}),Se[`${c}-${n.actionName}`]=n,n},async restoreDefaultShortcut(c){let n=r.getDefaultShortcuts()[c];return r.setShortcut(c,n)},handleKeydownEvent(c){let n=Ie(c),l=r.getShortcutKeys(),o=fe(l).find(i=>Te(n,l[i]));o&&(c?.preventDefault&&c.preventDefault(),r.handleShortcutFeature(o))},handleShortcutFeature(c){let{layout:{isFullscreen:n,showNav:l,showPanel:s},ui:{enableShortcuts:o}}=e.getState();if(!!o)switch(c){case"escape":{n?t.toggleFullscreen():l||t.toggleNav();break}case"focusNav":{n&&t.toggleFullscreen(),l||t.toggleNav(),t.focusOnUIElement(G.storyListMenu);break}case"search":{n&&t.toggleFullscreen(),l||t.toggleNav(),setTimeout(()=>{t.focusOnUIElement(G.storySearchField,!0)},0);break}case"focusIframe":{let i=Be.getElementById("storybook-preview-iframe");if(i)try{i.contentWindow.focus()}catch{}break}case"focusPanel":{n&&t.toggleFullscreen(),s||t.togglePanel(),t.focusOnUIElement(G.storyPanelRoot);break}case"nextStory":{t.jumpToStory(1);break}case"prevStory":{t.jumpToStory(-1);break}case"nextComponent":{t.jumpToComponent(1);break}case"prevComponent":{t.jumpToComponent(-1);break}case"fullScreen":{t.toggleFullscreen();break}case"togglePanel":{n&&(t.toggleFullscreen(),t.resetLayout()),t.togglePanel();break}case"toggleNav":{n&&(t.toggleFullscreen(),t.resetLayout()),t.toggleNav();break}case"toolbar":{t.toggleToolbar();break}case"panelPosition":{n&&t.toggleFullscreen(),s||t.togglePanel(),t.togglePanelPosition();break}case"aboutPage":{t.navigate("/settings/about");break}case"shortcutsPage":{t.navigate("/settings/shortcuts");break}case"collapseAll":{t.collapseAll();break}case"expandAll":{t.expandAll();break}default:Se[c].action();break}}},{shortcuts:a=M}=e.getState(),d={shortcuts:fe(M).reduce((c,n)=>({...c,[n]:a[n]||M[n]}),M)};return{api:r,state:d,init:()=>{Be.addEventListener("keydown",c=>{ho(c)||t.handleKeydownEvent(c)}),t.on(go,c=>{t.handleKeydownEvent(c.event)})}}};var be={};I(be,{init:()=>Oo});import{once as W}from"@storybook/client-logger";import{NAVIGATE_URL as Po,STORY_ARGS_UPDATED as vo,SET_CURRENT_STORY as xo,GLOBALS_UPDATED as Eo,UPDATE_QUERY_PARAMS as Ro}from"@storybook/core-events";import{queryFromLocation as Io,buildArgsParam as Qe}from"@storybook/router";import{toId as To,sanitize as Ao}from"@storybook/csf";import{dequal as We}from"dequal";import wo from"global";import{dedent as Y}from"ts-dedent";var{window:ge}=wo,H=e=>{if(e==="true"||e==="1")return!0;if(e==="false"||e==="0")return!1},he,Co=({state:{location:e,path:t,viewMode:r,storyId:a},singleStory:d})=>{let{full:p,panel:c,nav:n,shortcuts:l,addonPanel:s,tabs:o,addons:i,panelRight:u,stories:f,selectedKind:S,selectedStory:y,path:m,...g}=Io(e),h={isFullscreen:H(p),showNav:!d&&H(n),showPanel:H(c),panelPosition:["right","bottom"].includes(c)?c:void 0,showTabs:H(o)},v={enableShortcuts:H(l)},E=s||void 0;i==="0"&&(W.warn(Y`
      The 'addons' query param is deprecated and will be removed in Storybook 7.0. Use 'panel=false' instead.

      More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-layout-url-params
    `),h.showPanel=!1),u==="1"&&(W.warn(Y`
      The 'panelRight' query param is deprecated and will be removed in Storybook 7.0. Use 'panel=right' instead.

      More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-layout-url-params
    `),h.panelPosition="right"),f==="0"&&(W.warn(Y`
      The 'stories' query param is deprecated and will be removed in Storybook 7.0. Use 'nav=false' instead.

      More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-layout-url-params
    `),h.showNav=!1);let x=a;!x&&S&&(W.warn(Y`
      The 'selectedKind' and 'selectedStory' query params are deprecated and will be removed in Storybook 7.0. Use 'path' instead.

      More info: https://github.com/storybookjs/storybook/blob/next/MIGRATION.md#deprecated-layout-url-params
    `),x=y?To(S,y):Ao(S));let P=We(he,g)?he:g;return he=P,{viewMode:r,layout:h,ui:v,selectedPanel:E,location:e,path:t,customQueryParams:P,storyId:x}},Oo=({store:e,navigate:t,state:r,provider:a,fullAPI:d,...p})=>{let c=(s,o={},i={})=>{let u=Object.entries(o).filter(([,S])=>S).sort(([S],[y])=>S<y?-1:1).map(([S,y])=>`${S}=${y}`),f=[s,...u].join("&");return t(f,i)},n={getQueryParam(s){let{customQueryParams:o}=e.getState();return o?o[s]:void 0},getUrlState(){let{path:s,customQueryParams:o,storyId:i,url:u,viewMode:f}=e.getState();return{path:s,queryParams:o,storyId:i,url:u,viewMode:f}},setQueryParams(s){let{customQueryParams:o}=e.getState(),i={},u={...o,...Object.entries(s).reduce((f,[S,y])=>(y!==null&&(f[S]=y),f),i)};We(o,u)||(e.setState({customQueryParams:u}),d.emit(Ro,u))},navigateUrl(s,o){t(s,{...o,plain:!0})}},l=()=>{let s=()=>{let{path:i,queryParams:u,viewMode:f}=d.getUrlState();if(f!=="story")return;let S=d.getCurrentStoryData();if(S?.type!=="story")return;let{args:y,initialArgs:m}=S,g=Qe(m,y);c(i,{...u,args:g},{replace:!0}),n.setQueryParams({args:g})};d.on(xo,()=>s());let o;d.on(vo,()=>{"requestIdleCallback"in ge?(o&&ge.cancelIdleCallback(o),o=ge.requestIdleCallback(s,{timeout:1e3})):(o&&clearTimeout(o),setTimeout(s,100))}),d.on(Eo,({globals:i,initialGlobals:u})=>{let{path:f,queryParams:S}=d.getUrlState(),y=Qe(u,i);c(f,{...S,globals:y},{replace:!0}),n.setQueryParams({globals:y})}),d.on(Po,(i,u)=>{d.navigateUrl(i,u)}),d.showReleaseNotesOnLaunch()&&t("/settings/release-notes")};return{api:n,state:Co({store:e,navigate:t,state:r,provider:a,fullAPI:d,...p}),init:l}};var Pe={};I(Pe,{init:()=>No});import ko from"global";import w from"@storybook/semver";import Do from"memoizerific";var Ye="7.0.0-alpha.35";var{VERSIONCHECK:Mo}=ko,ze=Do(1)(()=>{try{return{...JSON.parse(Mo).data||{}}}catch{return{}}}),No=({store:e,mode:t,fullAPI:r})=>{let{dismissedVersionNotification:a}=e.getState(),d={versions:{current:{version:Ye},...ze()},dismissedVersionNotification:a},p={getCurrentVersion:()=>{let{versions:{current:n}}=e.getState();return n},getLatestVersion:()=>{let{versions:{latest:n,next:l,current:s}}=e.getState();return s&&w.prerelease(s.version)&&l?n&&w.gt(n.version,l.version)?n:l:n},versionUpdateAvailable:()=>{let n=p.getLatestVersion(),l=p.getCurrentVersion();if(n){if(!n.version||!l.version)return!0;let o=!!w.prerelease(l.version)?`${w.major(l.version)}.${w.minor(l.version)}.${w.patch(l.version)}`:l.version,i=w.diff(o,n.version);return w.gt(n.version,o)&&i!=="patch"&&!i.includes("pre")}return!1}};return{init:async()=>{let{versions:n={}}=e.getState(),{latest:l,next:s}=ze();if(await e.setState({versions:{...n,latest:l,next:s}}),p.versionUpdateAvailable()){let o=p.getLatestVersion().version,i=w.diff(n.current.version,n.latest.version);o!==a&&i!=="patch"&&!w.prerelease(o)&&t!=="production"&&r.addNotification({id:"update",link:"/settings/about",content:{headline:`Storybook ${o} is available!`,subHeadline:`Your current version is: ${n.current.version}`},icon:{name:"book"},onClear(){e.setState({dismissedVersionNotification:o},{persistence:"permanent"})}})}},state:d,api:p}};var ve={};I(ve,{init:()=>jo});import{SET_GLOBALS as Lo,UPDATE_GLOBALS as Fo,GLOBALS_UPDATED as Vo}from"@storybook/core-events";import{logger as Xe}from"@storybook/client-logger";import{dequal as Je}from"dequal";var jo=({store:e,fullAPI:t})=>{let r={getGlobals(){return e.getState().globals},getGlobalTypes(){return e.getState().globalTypes},updateGlobals(c){t.emit(Fo,{globals:c,options:{target:"storybook-preview-iframe"}})}},a={globals:{},globalTypes:{}},d=c=>{let n=e.getState()?.globals;Je(c,n)||e.setState({globals:c})};return{api:r,state:a,init:()=>{t.on(Vo,function({globals:n}){let{ref:l}=A(this,t);l?Xe.warn("received a GLOBALS_UPDATED from a non-local ref. This is not currently supported."):d(n)}),t.on(Lo,function({globals:n,globalTypes:l}){let{ref:s}=A(this,t),o=e.getState()?.globals;s?Object.keys(n).length>0&&Xe.warn("received globals from a non-local ref. This is not currently supported."):e.setState({globals:n,globalTypes:l}),o&&Object.keys(o).length!==0&&!Je(n,o)&&r.updateGlobals(o)})}}};var{ActiveTabs:kn}=q;var z=Ae({api:void 0,state:_({})}),Ve=(...e)=>_o({},...e,(t,r)=>{if(Array.isArray(r))return r}),xe=class extends Go{constructor(r){super(r);this.api={};this.initModules=()=>{this.modules.forEach(r=>{"init"in r&&r.init()})};let{location:a,path:d,refId:p,viewMode:c=r.docsOptions.docsMode?"docs":"story",singleStory:n,storyId:l,docsOptions:s,navigate:o}=r,i=new F({getState:()=>this.state,setState:(g,h)=>this.setState(g,h)}),u={location:a,path:d,viewMode:c,singleStory:n,storyId:l,refId:p},f={docsOptions:s};this.state=i.getInitialState(_({...u,...f}));let S={navigate:o,store:i,provider:r.provider};this.modules=[ee,re,oe,q,ne,se,ae,me,ue,le,ve,be,Pe].map(g=>g.init({...u,...f,...S,state:this.state,fullAPI:this.api}));let y=_(this.state,...this.modules.map(g=>g.state)),m=Object.assign(this.api,{navigate:o},...this.modules.map(g=>g.api));this.state=y,this.api=m}static getDerivedStateFromProps(r,a){return a.path!==r.path?{...a,location:r.location,path:r.path,refId:r.refId,viewMode:r.viewMode,storyId:r.storyId}:null}shouldComponentUpdate(r,a){let d=this.state,p=this.props;return d!==a||p.path!==r.path}render(){let{children:r}=this.props,a={state:this.state,api:this.api};return N.createElement(Bo,{effect:this.initModules},N.createElement(z.Provider,{value:a},N.createElement(Qo,null,r)))}};xe.displayName="Manager";var Bo=({children:e,effect:t})=>(N.useEffect(t,[]),e),qo=e=>e;function Qo({filter:e=qo,children:t}){let r=Re(z),a=et(t),d=et(e);if(typeof a.current!="function")return N.createElement(Ho,null,a.current);let p=d.current(r),c=Ee(()=>[...Object.entries(p).reduce((n,l)=>n.concat(l),[])],[r.state]);return Ee(()=>{let n=a.current;return N.createElement(n,{...p})},c)}function Dn(){let{state:e}=Re(z);return e}function k(){let{api:e}=Re(z);return e}function ot(e,t){return typeof e>"u"?t:e}var Wo=(e,t=[])=>{let r=k();return Uo(()=>(Object.entries(e).forEach(([a,d])=>r.on(a,d)),()=>{Object.entries(e).forEach(([a,d])=>r.off(a,d))}),t),r.emit};function Mn(e){return k().isPrepared(e)}function Nn(e,t){let a=k().getCurrentParameter(e);return ot(a,t)}var C={};function Yo(e,t){let r=k(),a=r.getAddonState(e),d=ot(a,C[e]?C[e]:t),p=(l,s)=>{C[e]&&(C[e]=l),r.setAddonState(e,l,s)},c=Ee(()=>{let l={[`${tt}-client-${e}`]:o=>p(o),[`${U}-client-${e}`]:o=>p(o)},s={[Ko]:()=>{let o=r.getAddonState(e);o?(C[e]=o,r.emit(`${U}-manager-${e}`,o)):C[e]?(p(C[e]),r.emit(`${U}-manager-${e}`,C[e])):t!==void 0&&(p(t),C[e]=t,r.emit(`${U}-manager-${e}`,t))},[$o]:()=>{let o=r.getAddonState(e);o!==void 0&&r.emit(`${U}-manager-${e}`,o)}};return{...l,...s}},[e]),n=Wo(c);return[d,(l,s)=>{p(l,s),n(`${tt}-manager-${e}`,l)}]}function Ln(e,t){return Yo(e,t)}function Fn(){let{getCurrentStoryData:e,updateStoryArgs:t,resetStoryArgs:r}=k(),a=e(),d=a.type==="story"?a.args:{},p=Ze(n=>t(a,n),[a,t]),c=Ze(n=>r(a,n),[a,r]);return[d,p,c]}function Vn(){let e=k();return[e.getGlobals(),e.updateGlobals]}function jn(){return k().getGlobalTypes()}function zo(){let{getCurrentStoryData:e}=k();return e()}function Gn(){let e=zo();return e?.type==="story"&&e.argTypes||{}}export{kn as ActiveTabs,Qo as Consumer,z as ManagerContext,xe as Provider,Ve as combineParameters,T as merge,Ln as useAddonState,Gn as useArgTypes,Fn as useArgs,Wo as useChannel,jn as useGlobalTypes,Vn as useGlobals,Nn as useParameter,Yo as useSharedState,Mn as useStoryPrepared,k as useStorybookApi,Dn as useStorybookState};
